<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.4c404821bb739f1ec46d.css">code[class*=language-],pre[class*=language-]{text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;color:#c3cee3;background:#263238;font-family:Roboto Mono,monospace;font-size:1em;line-height:1.5em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#363636}:not(pre)>code[class*=language-]{white-space:normal;border-radius:.2em;padding:.1em}pre[class*=language-]{overflow:auto;position:relative;margin:.5em 0;padding:1.25em 1em}.language-css>code,.language-sass>code,.language-scss>code{color:#fd9170}[class*=language-] .namespace{opacity:.7}.token.atrule{color:#c792ea}.token.attr-name{color:#ffcb6b}.token.attr-value,.token.attribute{color:#c3e88d}.token.boolean{color:#c792ea}.token.builtin{color:#ffcb6b}.token.cdata,.token.char{color:#80cbc4}.token.class{color:#ffcb6b}.token.class-name,.token.color{color:#f2ff00}.token.comment{color:#546e7a}.token.constant{color:#c792ea}.token.deleted{color:#f07178}.token.doctype{color:#546e7a}.token.entity{color:#f07178}.token.function{color:#c792ea}.token.hexcode{color:#f2ff00}.token.id,.token.important{color:#c792ea;font-weight:700}.token.inserted{color:#80cbc4}.token.keyword{color:#c792ea;font-style:italic}.token.number{color:#fd9170}.token.operator{color:#89ddff}.token.prolog{color:#546e7a}.token.property{color:#80cbc4}.token.pseudo-class,.token.pseudo-element{color:#c3e88d}.token.punctuation{color:#89ddff}.token.regex{color:#f2ff00}.token.selector{color:#f07178}.token.string{color:#c3e88d}.token.symbol{color:#c792ea}.token.tag,.token.unit{color:#f07178}.token.url{color:#fd9170}.token.variable{color:#f07178}.border-responsive{border-bottom:1px solid hsla(0,0%,100%,.3)}@media (min-width:768px){.border-responsive{border-bottom:none;border-right:1px solid hsla(0,0%,100%,.3)}}section{padding-top:1rem}pre{border-radius:15px;font-size:.9rem!important}blockquote{font-style:italic;padding-left:1rem;border-left:3px solid #e31b6d;opacity:.8}article header h1{color:#fff}section h1,section h2,section h3,section h4,section h5,section h6{margin-top:3rem!important;margin-bottom:1.5rem!important;color:#fff}</style><meta name="generator" content="Gatsby 2.23.23"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" title="Trainto.log()" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=9074198e5278012ba75f6b2cd64df7fa"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#e31b6d"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=9074198e5278012ba75f6b2cd64df7fa"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=9074198e5278012ba75f6b2cd64df7fa"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=9074198e5278012ba75f6b2cd64df7fa"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=9074198e5278012ba75f6b2cd64df7fa"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=9074198e5278012ba75f6b2cd64df7fa"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=9074198e5278012ba75f6b2cd64df7fa"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=9074198e5278012ba75f6b2cd64df7fa"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=9074198e5278012ba75f6b2cd64df7fa"/><title data-react-helmet="true">Android - Replace EventBus with LiveData | Trainto.log()</title><link data-react-helmet="true" rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"/><link data-react-helmet="true" href="https://fonts.googleapis.com/css?family=Noto+Sans&amp;display=swap" rel="stylesheet"/><meta data-react-helmet="true" name="description" content="Google announced a new set of architecture libraries. One of the new compoenents is LiveData, which can be used to manage propagating data to the views, while…"/><meta data-react-helmet="true" property="og:title" content="Android - Replace EventBus with LiveData"/><meta data-react-helmet="true" property="og:description" content="Google announced a new set of architecture libraries. One of the new compoenents is LiveData, which can be used to manage propagating data to the views, while…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Hakjoon Sim"/><meta data-react-helmet="true" name="twitter:title" content="Android - Replace EventBus with LiveData"/><meta data-react-helmet="true" name="twitter:description" content="Google announced a new set of architecture libraries. One of the new compoenents is LiveData, which can be used to manage propagating data to the views, while…"/><style data-react-helmet="true" type="text/css">
            body {
              background-color: #282c35;
              color: rgba(255, 255, 255, 0.88);
              font-family: 'Noto Sans', sans-serif;
            }

            a, a:hover {
              color: #e31b6d;
            }

            hr {
              background-color: rgba(255, 255, 255, 0.3);
            }
          </style><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><script data-ad-client="ca-pub-6978978720477594" async="" type="text/javascript" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><link as="script" rel="preload" href="/webpack-runtime-346de5a46c3115706876.js"/><link as="script" rel="preload" href="/framework-5fc6169171e885c3b522.js"/><link as="script" rel="preload" href="/app-d367110d0bccd7e4734e.js"/><link as="script" rel="preload" href="/styles-c2fe8482057191dca484.js"/><link as="script" rel="preload" href="/commons-5650f931b83acdae3c7a.js"/><link as="script" rel="preload" href="/1741fef513eed36a9117166ed65840855fa4f054-363b6acd4e05c8b9c309.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-2cbb95d4aa4075e31a83.js"/><link as="fetch" rel="preload" href="/page-data/android-replace-eventbus-with-livedata/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="d-none d-xl-block fixed-top" style="top:100px;width:160px;height:600px"><span class="position-relative"><ins class="adsbygoogle" style="display:inline-block;width:160px;height:600px" data-ad-client="ca-pub-6978978720477594" data-ad-slot="8329899743" data-full-width-responsive="false"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></span></div><div class="container py-3"><main><div class="row justify-content-center"><header class="col-12 col-md-8"><h3><a style="text-decoration:none" href="/">Trainto.log()</a></h3></header><div class="col-12 col-md-8 mt-3"><article><header><h1>Android - Replace EventBus with LiveData</h1><p>February 12, 2018</p></header><section><p>Google announced a new set of <a href="https://developer.android.com/topic/libraries/architecture/index.html">architecture libraries</a>. One of the new compoenents is <a href="https://developer.android.com/topic/libraries/architecture/livedata.html">LiveData</a>, which can be used to manage propagating data to the views, while respecting the view’s lifecycles. It means you don’t have to care about view’s lifecycles anymore.</p>
<p>Using this LiveData, an event bus can be implemented without any 3rd party libraries like <a href="http://square.github.io/otto/">Otto</a>. It also can be achieved using Rx, but with Rx, it can easily lead to memory leaks unless subscriptions managed carefully. With LiveData, we don’t have to worry about memory leaks or view’s lifecycles.</p>
<p>Let’s start with implementation. (Kotlin will be used)</p>
<p>To use LiveData in your application, dependencies should be applied to your gradle configuration.</p>
<div class="gatsby-highlight" data-language="groovy"><pre class="language-groovy"><code class="language-groovy"><span class="token comment">// This includes LiveDdata and ViewModel</span>
<span class="token comment">// If you want to add just LiveData, then use</span>
<span class="token comment">// "android.arch.lifecycle:livedata:x.x.x"</span>
implementation <span class="token string gstring">"android.arch.lifecycle:extensions:1.1.0"</span></code></pre></div>
<p>Ok, everything’s set to start.</p>
<p>We need a class holds livedata(event) first.</p>
<div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">object</span> EventProvider <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">val</span> liveDataEvent <span class="token operator">=</span> MutableLiveData<span class="token operator">&lt;</span>Event<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">fun</span> <span class="token function">post</span><span class="token punctuation">(</span>event<span class="token operator">:</span> Any<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>liveDataEvent<span class="token punctuation">.</span><span class="token function">postValue</span><span class="token punctuation">(</span><span class="token function">Event</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fun</span> <span class="token function">getEventLiveData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> MutableLiveData<span class="token operator">&lt;</span>Event<span class="token operator">></span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> liveDataEvent
    <span class="token punctuation">}</span>


    <span class="token keyword">class</span> <span class="token function">Event</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword">val</span> value<span class="token operator">:</span>Any<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token keyword">var</span> isConsumed <span class="token operator">=</span> <span class="token boolean">false</span>

        <span class="token keyword">fun</span> <span class="token function">setConsumed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            isConsumed <span class="token operator">=</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">fun</span> <span class="token function">isConsumed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Boolean <span class="token punctuation">{</span>
            <span class="token keyword">return</span> isConsumed
        <span class="token punctuation">}</span>

        <span class="token keyword">fun</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Any <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>This class is singleton and holds MutalbeLiveData<Event>. The Event class’s value field has Any type so that any type of data can be sent through this EvnetProvider. And Event can be submmited through post function. Also note that the Event class has isConsumed field. This is due to the behaviour of LiveData which it sends out when new observer is registered. This is totally fine if it is for propagating values, but here LiveData is used for Event Bus, so we don’t want to receive events every time activities created and registered.</p>
<p>Ok, now we prepared event bus. Now let’s subscribe this event bus from the view(activity).</p>
<div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">abstract</span> <span class="token keyword">class</span> BaseActivity <span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>

        EventProvider<span class="token punctuation">.</span><span class="token function">getEventLiveData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> Observer <span class="token punctuation">{</span>
            it<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">let</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>it<span class="token punctuation">.</span><span class="token function">isConsumed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">handleEventBus</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                it<span class="token punctuation">.</span><span class="token function">setConsumed</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token keyword">fun</span> <span class="token function">handleEventBus</span><span class="token punctuation">(</span>value<span class="token operator">:</span> Any<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">when</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">is</span> String <span class="token operator">-></span> Log<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"Event"</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>I mentioned that with LiveData, we don’t have to care about view’s lifecycles. To take this advantage, activity should extend android.support.vy.app.AppCompatActivity.(For fragment, it should extends android.support.v4.app.Fragment) Because these support libraries are already integrated with LifecycleOwners.</p>
<p>This BaseActivity subscribes the event bus through call observe(LifecyclerOwner, Observer) of the LiveData inside of EventProvider on its onCreate() lifecycle. When event occurred, Observer checks if this event consumed before, if it’s not, then call handleEventBus function.</p>
<p>Now you can create activities extends this BaseActivity, and override the handleEventBus to make the activity has its own behaviour to the specific event.</p></section><br/><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-6978978720477594" data-ad-slot="4364348128" data-ad-format="horizontal" data-full-width-responsive="false"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><hr class="my-4"/><footer><div><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:50px;height:50px;margin-bottom:0;min-width:50px;border-radius:100%"><img aria-hidden="true" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAIDAQb/xAAWAQEBAQAAAAAAAAAAAAAAAAACAQD/2gAMAwEAAhADEAAAAanfptN1PndBawj/AP/EABkQAAIDAQAAAAAAAAAAAAAAAAECAAMSEf/aAAgBAQABBQK7XAtlSywDCZM6IWJZiddLT//EABURAQEAAAAAAAAAAAAAAAAAACBB/9oACAEDAQE/AYP/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAeEAABAwQDAAAAAAAAAAAAAAABAAIREBIhQTFhcf/aAAgBAQAGPwINbtXF0jYpBOV7QHtRPCyv/8QAGxABAAIDAQEAAAAAAAAAAAAAAQAhETFBEFH/2gAIAQEAAT8hXQ9/IIs/hiw4QN2oXLdEQzl6m9MaRuNUqf/aAAwDAQACAAMAAAAQJy9//8QAFxEBAQEBAAAAAAAAAAAAAAAAAAERIf/aAAgBAwEBPxDJ01Vf/8QAGBEBAQADAAAAAAAAAAAAAAAAAQAQETH/2gAIAQIBAT8QF3g7AX//xAAcEAEBAAMBAAMAAAAAAAAAAAABEQAhQTFRsfD/2gAIAQEAAT8Q8Sqi+AuGBMCj1lLm/jA0aGDHeeyhEdr+MRQg3ric1Arbsn1k/kNtmRgpCvM//9k=" alt="Hakjoon Sim" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms;border-radius:50%"/><noscript><picture><source srcset="/static/11d9aa0a042029a130f7ad2d42e2f7d0/99438/profile-pic.jpg 1x,
/static/11d9aa0a042029a130f7ad2d42e2f7d0/aba1d/profile-pic.jpg 1.5x,
/static/11d9aa0a042029a130f7ad2d42e2f7d0/b315d/profile-pic.jpg 2x" /><img loading="lazy" width="50" height="50" srcset="/static/11d9aa0a042029a130f7ad2d42e2f7d0/99438/profile-pic.jpg 1x,
/static/11d9aa0a042029a130f7ad2d42e2f7d0/aba1d/profile-pic.jpg 1.5x,
/static/11d9aa0a042029a130f7ad2d42e2f7d0/b315d/profile-pic.jpg 2x" src="/static/11d9aa0a042029a130f7ad2d42e2f7d0/99438/profile-pic.jpg" alt="Hakjoon Sim" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><p>Written by<!-- --> <strong><a href="https://twitter.com/trainto" target="_blank" rel="noopener noreferrer">Hakjoon Sim</a></strong> <!-- -->who lives Seoul. Like programming and doing nothing.</p></div></footer></article><nav><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/kotlin-magic-with-let-apply-run-and-with/">← <!-- -->Kotlin - Kotlin&#x27;s magic with let, apply, run and with</a></li><li><a rel="next" href="/android-implementing-zip-function-using-livedata/">Android - Implementing Zip function using LiveData<!-- --> →</a></li></ul></nav></div></div></main></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-73310674-3', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/android-replace-eventbus-with-livedata/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-d367110d0bccd7e4734e.js"],"component---src-pages-404-js":["/component---src-pages-404-js-3fdf84ee86a6f94ab86c.js"],"component---src-templates-blog-list-js":["/component---src-templates-blog-list-js-ed4f6d8b33b7bbdeb0cb.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-2cbb95d4aa4075e31a83.js"]};/*]]>*/</script><script src="/component---src-templates-blog-post-js-2cbb95d4aa4075e31a83.js" async=""></script><script src="/1741fef513eed36a9117166ed65840855fa4f054-363b6acd4e05c8b9c309.js" async=""></script><script src="/commons-5650f931b83acdae3c7a.js" async=""></script><script src="/styles-c2fe8482057191dca484.js" async=""></script><script src="/app-d367110d0bccd7e4734e.js" async=""></script><script src="/framework-5fc6169171e885c3b522.js" async=""></script><script src="/webpack-runtime-346de5a46c3115706876.js" async=""></script></body></html>